<!DOCTYPE html>
<html>
  <head>
    <title>Weather Wireframe by Livinda</title>
    <meta charset="UTF-8" />
    <link href="styles.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <script
      src="https://kit.fontawesome.com/c434693770.js"
      crossorigin="anonymous"
    ></script>
    
  </head>

  <body>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <div class="container border border-success p-4 border-opacity-10 rounded-1 mt-5">
      <div class="row">
        <div class="col">
          <form class="search-form" id="search-form">
            <div class="input-group mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="enter-city"
                  placeholder="Enter city..."
                  aria-label="Enter city..."
                />
                <button class="btn btn-primary" type="submit" id="button-submit">
                  <i class="fa-solid fa-magnifying-glass"></i>
                </button>
              </div>
            </div>
            <div class="col">
              <button type="button" class="btn btn-outline-primary my-location" id="my-location">
                <i class="fa-solid fa-location-dot"></i> My Location
              </button>
            </div>  
            </div>
          </form>
      <div class="weather-details">
        <h1 id="city-name">
          Bali
        </h1>
        <h4 id="thisDate">
          
        </h4>
        <div class="row">
          <div class="col-6">
            <h6 class="meteo">
              Overcast cloud
            </h6>
            <?xml version="1.0" encoding="iso-8859-1"?>
            <!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
            <svg
              version="1.1"
              id="Layer_1"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              x="0px"
              y="0px"
              viewBox="0 0 485 485"
              style="enable-background: new 0 0 485 485;"
              xml:space="preserve"
              class="cloud"
            >
              <path
                d="M485,214.04c0-39.199-28.706-71.819-66.201-77.947c-11.772-51.31-57.695-88.639-111.478-88.639
    c-48.103,0-90.978,30.346-107.367,74.864c-55.911,12.776-100.346,57.227-112.082,114.524C38.375,243.191,0,285.59,0,336.783
    c0,55.561,45.202,100.763,100.763,100.763h264.601c55.561,0,100.763-45.202,100.763-100.763c0-20.852-6.369-40.242-17.261-56.334
    C471.077,266.202,485,241.528,485,214.04z M307.322,77.454c42.764,0,78.789,31.97,83.798,74.366l1.564,13.24h13.332
    c27.01,0,48.984,21.973,48.984,48.98c0,18.897-10.598,35.657-27.05,43.832c-14.023-11.145-31.071-18.641-49.695-21.031
    c-13.858-67.654-73.302-117.397-143.4-118.233C249.82,93.616,277.171,77.454,307.322,77.454z M365.364,407.546H100.763
    C61.744,407.546,30,375.802,30,336.783s31.746-70.763,70.768-70.763H114.1l1.564-13.24c7.018-59.399,57.489-104.191,117.399-104.191
    s110.381,44.792,117.399,104.191l1.564,13.24h13.332c39.021,0,70.768,31.744,70.768,70.763S404.383,407.546,365.364,407.546z"
              />
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
              <g></g>
            </svg>
            <div class="temperature">
              <h2 id="current-temperature">
                30° C 
              </h2>
            </div>
          </div>
          <div class="col-4">
            <div class="weather-desc">
              <h6 class="desc">
                <i class="fa-solid fa-droplet"></i> Humidity: <span id="humidity">70</span>%
              </h6>
              <h6 class="desc">
                <i class="fa-solid fa-wind"></i>  Wind: <span id="wind">4</span> km/h
              </h6>
            </div>
          </div>
        </div>

        <div class="row mt-5">
         <div class="card weekly-meteo">
            <div class="card-body day-content">
              <h5 class="card-title day">Saturday</h5>
              <i class="fa-solid fa-cloud-showers-heavy"></i>
              <p class="card-text weekly-meteo-desc">
                Max: 30° C
                Min: 23° C
              </p>
            </div>
          </div>
          <div class="card weekly-meteo">
            <div class="card-body day-content">
              <h5 class="card-title day">Sunday</h5>
              <i class="fa-solid fa-cloud-sun"></i>
              <p class="card-text weekly-meteo-desc">
                  Max: 30° C
                  Min: 24° C
                </p>
            </div>
          </div>
          <div class="card weekly-meteo">
            <div class="card-body day-content">
              <h5 class="card-title day">Monday</h5>
              <i class="fa-solid fa-cloud-bolt"></i>
              <p class="card-text weekly-meteo-desc">
                  Max: 30° C
                  Min: 24° C
                </p>
            </div>
          </div>
          <div class="card weekly-meteo">
            <div class="card-body day-content">
              <h5 class="card-title day">Tuesday</h5>
              <i class="fa-solid fa-cloud"></i>
              <p class="card-text weekly-meteo-desc">
                  Max: 28° C
                  Min: 24° C
                </p>
            </div>
          </div>
          <div class="card weekly-meteo">
            <div class="card-body day-content">
              <h5 class="card-title day">Wednesday</h5>
              <i class="fa-solid fa-cloud-sun"></i>
              <p class="card-text weekly-meteo-desc">
                  Max: 29° C
                  Min: 23° C
                </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<script>
  // Geolocation 
  let apiKey = "88ee3d64a1b4b3c87b724cbe8f9f9e1a";
  let tempTitle = document.querySelector('#current-temperature');
  let currentCity = document.querySelector('#city-name');

  let searchCity = document.querySelector('#button-submit');
  

  function displayWeatherCondition(response){
    console.log(response.data.name);
    document.querySelector('#city-name').innerHTML = response.data.name;
    document.querySelector('#current-temperature').innerHTML = `${Math.round(response.data.main.temp)} ℃`;
    document.querySelector('#humidity').innerHTML = response.data.main.humidity;
    document.querySelector('#wind').innerHTML = response.data.wind.speed;
  }

  function search(event){
    event.preventDefault();
    let cityName = document.querySelector('#enter-city').value;
    let apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${apiKey}&units=metric`;
    //currentCity.innerHTML = cityName;
    axios.get(apiUrl).then(displayWeatherCondition);
  }
  let form = document.querySelector("#search-form");
  form.addEventListener("submit", search);

  let button = document.querySelector('#my-location'); 

  button.addEventListener('click', () => {
    let long;
    let lat;
    

    // Accesing Geolocation of User
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        // Storing Longitude and Latitude in variables
        long = position.coords.longitude;
        lat = position.coords.latitude;
        let url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${long}&appid=${apiKey}&units=metric`;

        // Using fetch to get data
        fetch(url)
          .then((response) => {
            return response.json();
          })
          .then((data) => {
            let { temp } = data.main;
            let thisCity = data.name;
            let { humidity } = data.main;
            let thisWind = data.wind.speed;

            // Interacting with DOM to show data
            console.log(`${Math.round(temp.toFixed(2))} °C`);
            let currentTemp = Math.round(temp.toFixed(2));
            tempTitle.textContent = `${currentTemp} °C`;
            currentCity.textContent = `${thisCity}`;
            document.querySelector('#humidity').textContent = humidity;
            document.querySelector('#wind').textContent = thisWind;
            
          });
      });
    }
  });

  
</script>

    <script src="src/index.js"></script>
  </body>
</html>
